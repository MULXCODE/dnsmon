<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>environment/utils.js - DNSMON</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="DNSMON"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 14.4.29.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AggregationLevelConnector.html">AggregationLevelConnector</a></li>
            
                <li><a href="../classes/AntiFloodConnector.html">AntiFloodConnector</a></li>
            
                <li><a href="../classes/BreadcrumbsView.html">BreadcrumbsView</a></li>
            
                <li><a href="../classes/CacheConnectorAtlas.html">CacheConnectorAtlas</a></li>
            
                <li><a href="../classes/Cell.html">Cell</a></li>
            
                <li><a href="../classes/Connector.html">Connector</a></li>
            
                <li><a href="../classes/ConnectorFacade.html">ConnectorFacade</a></li>
            
                <li><a href="../classes/ControlPanelView.html">ControlPanelView</a></li>
            
                <li><a href="../classes/ErrorsHandlerConnectorAtlas.html">ErrorsHandlerConnectorAtlas</a></li>
            
                <li><a href="../classes/FullScreenView.html">FullScreenView</a></li>
            
                <li><a href="../classes/GesturesManager.html">GesturesManager</a></li>
            
                <li><a href="../classes/HistoryManager.html">HistoryManager</a></li>
            
                <li><a href="../classes/IsolationLevelConnectorAtlas.html">IsolationLevelConnectorAtlas</a></li>
            
                <li><a href="../classes/MainView.html">MainView</a></li>
            
                <li><a href="../classes/ParamsManager.html">ParamsManager</a></li>
            
                <li><a href="../classes/PopUpView.html">PopUpView</a></li>
            
                <li><a href="../classes/Row.html">Row</a></li>
            
                <li><a href="../classes/SessionManager.html">SessionManager</a></li>
            
                <li><a href="../classes/SvgChartView.html">SvgChartView</a></li>
            
                <li><a href="../classes/SvgContainerView.html">SvgContainerView</a></li>
            
                <li><a href="../classes/SvgOrdinalAxisView.html">SvgOrdinalAxisView</a></li>
            
                <li><a href="../classes/SvgTimeAxisView.html">SvgTimeAxisView</a></li>
            
                <li><a href="../classes/TemplateManagerView.html">TemplateManagerView</a></li>
            
                <li><a href="../classes/TimeController.html">TimeController</a></li>
            
                <li><a href="../classes/TimeOverviewView.html">TimeOverviewView</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/connector.html">connector</a></li>
            
                <li><a href="../modules/connector.Atlas.html">connector.Atlas</a></li>
            
                <li><a href="../modules/controller.html">controller</a></li>
            
                <li><a href="../modules/environment.html">environment</a></li>
            
                <li><a href="../modules/model.html">model</a></li>
            
                <li><a href="../modules/session.html">session</a></li>
            
                <li><a href="../modules/view.html">view</a></li>
            
                <li><a href="../modules/view.svg.html">view.svg</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: environment/utils.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define([
    &quot;lib.date-format&quot;
], function(){

    /**
     * A collection of utilities
     */

    return {

        addMinutes: function(date, minutes){
            return new Date(date.getTime() + (minutes * 60 * 1000));
        },

        subMinutes: function(date, minutes){
            return new Date(date.getTime() - (minutes * 60 * 1000));
        },

        translate: function(pointsArray, vector){
            var item, translatedArray;

            translatedArray = [];

            for (var n=0,length=pointsArray.length; n&lt;length; n++){
                item = pointsArray[n];
                translatedArray.push({x: item.x + vector.x, y: item.y + vector.y});
            }
            return translatedArray;
        },

        computeColorScale: function(legend){
            var mapOut, legendItem;

            mapOut = {valueRange: [], colorRange: []};

            for (var n= 0,length=legend.length; n&lt;length; n++){
                legendItem = legend[n];

                mapOut.valueRange =  mapOut.valueRange.concat(legendItem.valueRange);
                mapOut.colorRange =  mapOut.colorRange.concat(legendItem.colorRange);
            }
            return mapOut;
        },

        getLongestString: function(arrayOfStrings){
            var maximum, item;

            maximum = -Infinity;
            for (var n=0,length=arrayOfStrings.length; n&lt;length; n++){
                item = arrayOfStrings[n].length;

                if (maximum &lt; item){
                    maximum = item;
                }
            }

            return maximum;
        },

        writeSvgText: function(container, textArray, position, padding){
            var textItem, actualPosition, interline, text;

            actualPosition = 0;
            interline = 15;

            container
                .selectAll(&quot;text&quot;)
                .remove();

            for (var n= 0,length=textArray.length; n&lt;length; n++){
                textItem = textArray[n];

                actualPosition = interline * n;

                container
                    .append(&quot;text&quot;)
                    .attr(&quot;class&quot;, &quot;popup-text&quot;)
                    .attr(&quot;dx&quot;, position.x + padding.left)
                    .attr(&quot;dy&quot;, position.y + actualPosition + padding.top)
                    .text(textItem);
            }

            return text;
        },

        lightClone: function(toBeCloned){
            var cloned, isArray;

            isArray = toBeCloned instanceof Array;

            if (isArray){
                cloned = [];

                for (var n= 0,length=toBeCloned.length; n&lt;length; n++){
                    cloned.push(toBeCloned[n]);
                }

            }else{
                cloned = {};

                for (var item in toBeCloned){
                    cloned[item] = toBeCloned[item];
                }
            }

            return cloned;
        },

        log: function(text, debug){
            if (debug){
                console.log(new Date(), text);
            }
        },

        getUrlParam: function(key){
            var regex, result, match, url;
            url = document.location.search;
            regex = new RegExp(&#x27;(?:\\?|&amp;)&#x27; + key + &#x27;=(.*?)(?=&amp;|$)&#x27;, &#x27;gi&#x27;);
            result = [];

            while ((match = regex.exec(url)) != null){
                result.push(match[1]);
            }
            return result;
        },

        indexOf: function(element, array){
            var index = -1;

            if (array.indexOf){
                index = array.indexOf(element);
            }else{

                for (var n=0, length=array.length; n&lt;length;n++){
                    if (array[n] == element){
                        index = n;
                        break;
                    }
                }
            }
            return index;
        },

        encapsulateDom: function(jQuerySelection){
            return {$: jQuerySelection, plain: jQuerySelection[0]};
        },

        loadCss: function(cssFile){
            var newLink = document.createElement(&#x27;link&#x27;);
            newLink.rel = &#x27;stylesheet&#x27;;
            newLink.type = &#x27;text/css&#x27;;
            newLink.href = cssFile;
            newLink.async = true;
            document.head.appendChild(newLink);
        },

        getRectangularVertexPoints: function(x, y, width, height){
            var leftTop, leftBottom, rightTop, rightBottom;

            leftTop = {x: x, y: y};
            leftBottom = {x: x, y: y + height};

            rightTop = {x: x + width, y: y};
            rightBottom = {x: x + width, y: y + height};

            return [leftTop, rightTop, rightBottom, leftBottom]; //returned clockwise
        },

        isThereAnIntersection: function(selectionVertices, cellVertices){
            var a, b, c, d, e, f, g, h, thereIsAnIntersection, cellCenter, isSelectionStartingInARect, isSelectionEndingInARect,
                intersectionPoint;

            a = selectionVertices[0];
            b = selectionVertices[1];
            c = selectionVertices[2];
            d = selectionVertices[3];

            e = cellVertices[0];
            f = cellVertices[1];
            g = cellVertices[2];
            h = cellVertices[3];

            intersectionPoint = this.getLinesIntersection(a, b, e, h);

            function isPointInside(a, b, c, d, p){
                return p.x &gt;= a.x &amp;&amp; p.x &lt;= b.x &amp;&amp; p.y &gt;= a.y &amp;&amp; p.y &lt;= d.y;
            }

            // Don&#x27;t declare the single items in dedicated vars in order to calculate them only if needed
            thereIsAnIntersection =
                isPointInside(e,f,g,h, a) || //Is It starting in a rect?
                isPointInside(a,b,c,d, this.getRectangleCenter(e, f, g, h)) ||
                isPointInside(a,b,c,d, e) ||
                isPointInside(a,b,c,d, h) ||
                isPointInside(a,b,c,d, g) ||
                isPointInside(a,b,c,d, f) ||
                isPointInside(e,f,g,h, c) || //Is it ending in a rect?
                (intersectionPoint != null);

            return thereIsAnIntersection;
        },

        getLinesIntersection: function(a, b, c, d){

            /// &quot;unroll&quot; the objects
            var p0x = a.x,
                p0y = a.y,
                p1x = b.x,
                p1y = b.y,
                p2x = c.x,
                p2y = c.y,
                p3x = d.x,
                p3y = d.y,

            /// calc difference between the coords
                d1x = p1x - p0x,
                d1y = p1y - p0y,
                d2x = p3x - p2x,
                d2y = p3y - p2y,

            /// determinator
                d = d1x * d2y - d2x * d1y,

                px, py,
                s, t;

            /// if is not intersecting/is parallel then return immediately
            if (d == 0.0)
                return null;

            /// solve x and y for intersecting point
            px = p0x - p2x;
            py = p0y - p2y;

            s = (d1x * py - d1y * px) / d;
            if (s &gt;= 0 &amp;&amp; s &lt;= 1) {

                /// if s was in range, calc t
                t = (d2x * py - d2y * px) / d;
                if (t &gt;= 0 &amp;&amp; t &lt;= 1) {

                    return {x: p0x + (t * d1x),
                        y: p0y + (t * d1y)}
                }
            }

            return null;
        },

        getRectangleCenter: function(a, b, c, d){
            var x, y;
            x = ((b.x - a.x) / 2) + a.x;
            y = ((d.y - a.y) / 2) + a.y;

            return {x: x, y: y};
        },

        join: function(array, char){
            var stringOut = &quot;&quot;;
            if (array.join){
                stringOut = array.join(char);
            }else{

                for (var n=0,length=array.length; n&lt;length; n++){
                    stringOut += array[n];
                    if (n != length-1){
                        stringOut += &#x27;&#x27; + char;
                    }
                }
            }

            return stringOut;
        },

        split: function(string, char, skipEmpty){
            var arrayOut, item, tmp;

            arrayOut = string.split(char);

            if (skipEmpty){

                tmp = [];

                for (var n=0,length=arrayOut.length; n&lt;length; n++){
                    item = arrayOut[n];
                    if (item != &#x27;&#x27;){
                        tmp.push(item);
                    }
                }

                arrayOut = tmp;
            }

            return arrayOut;
        },

        logOnce: function(log){
            if (!window.once){
                window.once = true;
                this.log(log);
            }
        },

        reduceCalls: function(reductionId, reductionFactor){
            var callNow;
            callNow = false;
            if (!window.reductionCallsCounters){
                window.reductionCallsCounters = {};
            }

            if (window.reductionCallsCounters[reductionId] == null){
                window.reductionCallsCounters[reductionId] = reductionFactor;
            }

            if (window.reductionCallsCounters[reductionId] == 0){
                callNow = true;
                window.reductionCallsCounters[reductionId] = reductionFactor
            }else{
                window.reductionCallsCounters[reductionId]--;
            }

            return callNow;
        },

        timestampToUTCDate: function(timestamp){
            var date = new Date(timestamp * 1000);
            return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(),  date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());
        },

        getInstanceSuffix: function(domName){
            var suffix;

            suffix = domName.replace(&#x27;.&#x27;, &#x27;&#x27;);
            suffix = suffix.replace(&#x27;#&#x27;, &#x27;&#x27;);

            return suffix;
        },

        getUrlParameters: function(domName) { // Get a map composed of ALL the parameters
            var map, suffix, parts, subElements, atLeastOne;

            map = {};
            atLeastOne = false;
            suffix = this.getInstanceSuffix(domName) + &#x27;.&#x27;;

            parts = window.location.href.replace(/[?&amp;]+([^=&amp;]+)=([^&amp;]*)/gi, function(m, key, value) {

                key = key.toString().replace(suffix, &#x27;&#x27;); // Creates the map removing the suffix

                if (key.indexOf(&#x27;.&#x27;) != -1){
                    subElements = key.split(&#x27;.&#x27;);
                    if (!map[subElements[0]]){
                        map[subElements[0]] = {};
                    }
                    map[subElements[0]][subElements[1]] = value;
                }else{
                    map[key] = value;
                }

                atLeastOne = true;
            });

            return (atLeastOne) ? map : null;
        },

        mergeMaps: function(map1, map2){
            var mapOut;

            mapOut = {};

            for (var key in map1){
                mapOut[key] = map1[key];
            }

            for (var key in map2){
                mapOut[key] = map2[key];
            }

            return mapOut;
        },

        isNumber: function(n) {
            return !isNaN(parseFloat(n)) &amp;&amp; isFinite(n);
        },

        dateToString: function(date){ //This is an indirection, may be useful in the future to manipulate dates
            return &quot;&quot; + date.getUTCFullYear() +
                &quot;-&quot; + (&#x27;0&#x27; + (date.getUTCMonth() + 1)).slice(-2) +
                &quot;-&quot; + (&#x27;0&#x27; + date.getUTCDate()).slice(-2) +
                &quot; &quot; + (&#x27;0&#x27; + date.getUTCHours()).slice(-2) +
                &quot;:&quot; + (&#x27;0&#x27; + date.getUTCMinutes()).slice(-2) +
                &quot;:&quot; + (&#x27;0&#x27; + date.getUTCSeconds()).slice(-2) +
                &quot; UTC&quot;;
        },

        dateToStringShort: function(date){ //This is an indirection, may be useful in the future to manipulate dates
            return &quot;&quot; + date.getUTCFullYear() +
                &quot;-&quot; + (&#x27;0&#x27; + (date.getUTCMonth() + 1)).slice(-2) +
                &quot;-&quot; + (&#x27;0&#x27; + date.getUTCDate()).slice(-2) +
                &quot; &quot; + (&#x27;0&#x27; + date.getUTCHours()).slice(-2) +
                &quot;:&quot; + (&#x27;0&#x27; + date.getUTCMinutes()).slice(-2);
        },

        timestampToLocalDate: function(timestamp){
            var date;
            date = new Date(timestamp * 1000);
            return date;
        },

        localDateToUTCDate: function(date){
            var utcDate;

            utcDate = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(),  date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());

            return utcDate;
        },

        UTCDateToLocalDate: function(date){
            return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(),  date.getHours(), date.getMinutes(), date.getSeconds()));
        },

        dateToUTCTimestamp: function(date){
            return Math.ceil(date.getTime()/1000);
//            return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(),  date.getHours(), date.getMinutes(), date.getSeconds())).getTime()/1000;
        },

        callCallbacks: function(list, parameters){
            var item;

            for (var n=0,length=list.length; n&lt;length; n++){
                item = list[n];
                item.call(this, parameters);
            }
        },

        getCurrentUrl: function(){
            return window.location.href;
        },

        setParam: function(key, value, url){
            var baseUrl, paramsUrl, pair, query, pairs, keyTmp, valueTmp, newPairs, inserted, questionMarkPosition,
                itemUrl;

            newPairs = [];
            inserted = false;

            if (url){
                questionMarkPosition = url.indexOf(&#x27;?&#x27;);
                if (questionMarkPosition == -1){
                    baseUrl = url;
                    paramsUrl = &#x27;&#x27;;
                }else{
                    baseUrl = url.substring(0, questionMarkPosition);
                    paramsUrl = url.substring(questionMarkPosition + 1, url.length);
                }
            }else{
                baseUrl = &#x27;&#x27;;
                paramsUrl = &#x27;&#x27;;
            }

            pairs = paramsUrl.split(&#x27;&amp;&#x27;);

            for(var n=0,length=pairs.length; n&lt;length;n++){
                itemUrl = pairs[n];

                if (itemUrl != &quot;&quot;){
                    pair = (itemUrl).split(&#x27;=&#x27;);

                    keyTmp = pair[0];
                    valueTmp = pair[1];

                    if (keyTmp == key){
                        if (value != null &amp;&amp; value != &#x27;&#x27;) {
                            newPairs.push(keyTmp + &quot;=&quot; + value);
                        }
                        inserted = true;
                    }else{
                        newPairs.push(keyTmp + &quot;=&quot; + valueTmp);
                    }
                }
            }

            if (!inserted){
                if (value != null &amp;&amp; value != &quot;&quot;){
                    newPairs.push(key + &quot;=&quot; + value);
                }
            }

            query = this.join(newPairs, &#x27;&amp;&#x27;);

            return baseUrl + &#x27;?&#x27; + query;
        },

        containsAll: function(containerArray, containedArray){
            var item;

            for (var n=0,length=containedArray.length; n&lt;length; n++){
                item = containedArray[n];
                if (this.indexOf(item, containerArray) == -1){
                    return false;
                }
            }

            return true;

        },

        objectSize : function(object) {
            var recurse, objectList, bytes;

            objectList = [];
            recurse = function( value ) {
                bytes = 0;

                if ( typeof value === &#x27;boolean&#x27; ) {
                    bytes = 4;
                } else if ( typeof value === &#x27;string&#x27; ) {
                    bytes = value.length * 2;
                } else if ( typeof value === &#x27;number&#x27; ) {
                    bytes = 8;
                } else if (typeof value === &#x27;object&#x27;
                    &amp;&amp; objectList.indexOf( value ) === -1) {
                    objectList[objectList.length] = value;
                    for( i in value ) {
                        bytes += 8;
                        bytes += recurse(value[i]);
                    }
                }
                return bytes;
            };

            return recurse(object);
        }

    };

});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
